<script>
    var items = [];
</script>
<div class="box box-default">
    <div class="box box-body">
        <form th:action="${'/'+pageURI+'/store'}" method="post" id="dialog-form" autocomplete="off">
            <div class="row">
                <div class="col-xs-4">
                    <label>Student</label>
                    <div class="input-group">
                        <select id="form-student-id" name="student.id" class="form-control" required="required">
                            <option value="">Select Student</option>
                            <option th:each="student:${students}" th:value="${student.id}"
                                th:text="${student.name}"></option>
                        </select>
                        <span class="input-group-btn">
                            <a href="javascript:void(0)" class="btn btn-primary add-student-btn" title="Add Student">
                                <span class="glyphicon glyphicon-plus"></span>
                        </a>
                        </span>
                    </div>
                </div>
            </div>

            <table id="product-detail-table" class="table item-table">
                <thead>
                    <tr>
                        <th>Subject</th>
                        <th>Mark</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody class="test" th:if="${request!=null}">

                    <tr class="table-row" th:if="${request!=null}" th:each="detail,num:${request.details}">

                        <td>
                            <select th:name="'details['+${num.index}+'].item.id'" class="form-control items" required="required">
                                <option value=''>Select Subject</option>
                                <option th:each="subject:${subjects}" th:rel="${subject.id}" th:value="${subject.id}"
                                    th:selected="${subject.id==detail.subject.id}" th:text="${subject.name}"></option>
                            </select>
                        </td>
                        <td>
                            <div class="input-group">
                                <input th:name="'details['+${num.index}+'].mark'" type="number" class="mark form-control" required="required" />
                            </div>
                        </td>
                        <td>
                            <a class="remove-item btn btn-danger btn-xs">
                                <span class="glyphicon glyphicon-trash"></span>
                            </a>
                        </td>
                        <script th:inline="javascript">
                            var $id = /*[[${detail.item.id}]]*/ ;
                            var $el = /*[[${num.index}]]*/ ;
                            items.push({
                                id: $id,
                                el: '#detail-brand-' + $el
                            });
                        </script>
                    </tr>
                </tbody>

                <tfoot>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td style="text-align:center">
                            <strong>Total:</strong></td>
                    </tr>
                </tfoot>
            </table>
            <input type="hidden" name="id" value="0" />
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <div class="row" style="text-align: center">
                <button type="submit" class="btn btn-success">Save</button>
                <a th:if="${param.ref!=null}" href="/purchase/requests" class="btn btn-danger">Back</a>
                <a th:unless="${param.ref!=null}" href="/purchase/orders" class="btn btn-danger">Back</a>
            </div>
        </form>
    </div>
</div>